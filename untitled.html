<html><head></head><body><script type='module'>
	import {FactorioData} from './data.js';
	import {util} from './util.js';
	function resolveAll(ps){
	  // ps is {key:promise ...}
	  // returns a Promise that resolves to {key:promise value}
	  // will reject with any error
	  var values={};
	  return Object.entries(ps).map(([k,p])=>p.then(data=>{values[k]=data;})).reduce((p1,p2)=>p1.then(()=>p2)).then(()=>values);
	}
	var datap=fetch('SE.json').then(r=>r.json());
	var localep=fetch('SElocale.json').then(r=>r.json());
	resolveAll({'data':datap,'locale':localep}).then(d=>{
		window['data']=new FactorioData(d.data,d.locale);
	});
	window['util']=util;
  import * as mdata from './data.js';
  import * as mimage from './image.js';
  import * as mnormalize from './normalize.js';
  import * as mprocess from './process.js';
  import * as mtowiki from './towiki.js';
  import * as mutil from './util.js';
  import * as mwikiapi from './wikiapi.js';
  window.wiki='https://spaceexploration.miraheze.org';
  window.mdata=mdata;
	window.mimage=mimage;
	window.mnormalize=mnormalize;
	window.mprocess=mprocess;
	window.mtowiki=mtowiki;
	window.mutil=mutil;
	window.mwikiapi=mwikiapi;
  import * as maccordion from './accordion.js';
	window.maccordion=maccordion;
  import * as meditjson from './editjson.js';
	window.meditjson=meditjson;
  //import * as m from './.js';
	//window.m=m;
</script>
<script>
	function getimage(data,size) {
    return mimage.makeicon(data,size).then(iconcanvas=>{
      var img=document.createElement('img');
      img.src=iconcanvas.toDataURL('image/png');
      document.querySelector('body').append(img);
    });
	}

	/*function addstyles(element,styles){
		// styles is {style name:style value}
		
	}*/

	function addclasses(element,classes){
		// classes is [class...]
		for(var c of classes){
			element.classList.add(c);
		}
	}

	function renderstructure(structure){
		var out
		if(structure.type=='accordion'){
			var contents=structure.contents.map(renderstructure);
			var div=document.createElement('div');
			div.append(...contents);
			out=maccordion.createaccordion(div);
		}else if(structure.type=='json'){
			out=meditjson.fromjson(structure.data);
		}else{
			var contents=structure.contents.map(renderstructure);
			var container=document.createElement(structure.type);
			container.append(...contents);
			out=container;
		}
		if('classes' in structure){
			addclasses(out,structure.classes);
		}
		return out;
	}

	function renderitem(data){
		var structure={}
	}

	function renderrecipe(){}

	function rendertech(){}

	function renderentity(){}
</script>
</body>
</html>